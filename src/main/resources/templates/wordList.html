<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="/style.css">

    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="setting-header">
    <a href="/" class="button" id="setting-back-button"> 돌아가기 </a>
    <div class="title">영단어 관리</div>
</div>
<div class="container">
    <div class="setting-div">
        <label for="dayChoose" class="plain-text">날짜 선택</label>
        <select id="dayChoose" name="dayType">
            <option value="DAY1">DAY 1</option>
            <option value="DAY2">DAY 2</option>
            <option value="DAY3">DAY 3</option>
            <option value="DAY4">DAY 4</option>
            <option value="DAY5">DAY 5</option>
            <option value="DAY6">DAY 6</option>
            <option value="DAY7">DAY 7</option>
            <option value="DAY8">DAY 8</option>
            <option value="DAY9">DAY 9</option>
            <option value="DAY10">DAY 10</option>

        </select>
    </div>
        <div class="sub-title">
            **단어 목록**
        </div>
        <div class="container" id="list">
            <table>
                <thead>
                    <tr>
                        <th>
                            영단어
                        </th>
                        <th>
                            의미
                        </th>
                        <th>
                            관리
                        </th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>

    <form class="container add-quiz" method="post" action="/setting">
        <div class="add-word-container">
            <div class="plain-text">단어 추가하기</div>
        <div class="setting-div">
            <label for="voca" class="plain-text">추가할 영단어:</label>
            <input type="text" id="voca" name="voca" class="input-box">
        </div>
        <div class="setting-div">
            <label for="meaning" class="plain-text">뜻:</label>
            <input type="text" id="meaning" name="meaning" class="input-box" placeholder="예)먹다/팔다/행상하다">
        </div>
            <button type="submit" class="button" id="setting-quiz-add-button">추가하기</button>

        </div>
    </form>
</div>
</body>
</html>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const daySelect = document.getElementById("dayChoose");
        const tableBody = document.querySelector("#list tbody");

        daySelect.addEventListener("change", function () {
            const selectedDay = this.value;

            fetch(`/api/words?day=${selectedDay}`)
                .then(response => response.json())
                .then(data => {
                    tableBody.innerHTML = ""; // 기존 테이블 비우기

                    if (data.length === 0) {
                        const row = document.createElement("tr");
                        const td = document.createElement("td");
                        td.colSpan = 3;
                        td.textContent = "단어가 존재하지 않습니다.";
                        row.appendChild(td);
                        tableBody.appendChild(row);
                    } else {
                        data.forEach(voca => {
                            const row = document.createElement("tr");

                            const wordTd = document.createElement("td");
                            wordTd.textContent = voca.word;
                            row.appendChild(wordTd);

                            const meaningTd = document.createElement("td");
                            meaningTd.textContent = voca.meaning;
                            row.appendChild(meaningTd);

                            const controlTd = document.createElement("td");

                            //수정하기 링크
                            const editLink = document.createElement("a");
                            editLink.href = `/setting/edit/${voca.id}`; // 경로 수정해야함
                            editLink.textContent = "수정하기";
                            editLink.classList.add("button-second");



                            // 삭제하기 링크
                            const deleteLink = document.createElement("a");
                            deleteLink.href = `/setting/delete/${voca.id}`; //경로 수정해야함
                            deleteLink.textContent = "삭제하기";
                            deleteLink.classList.add("button-second");


                            //둘다 controlId에 추가
                            controlTd.appendChild(editLink);
                            controlTd.appendChild(deleteLink);

                            row.appendChild(controlTd);

                            tableBody.appendChild(row);
                        });
                    }
                })
                .catch(error => {
                    console.error("에러 발생:", error);
                });
        });

        // 페이지 처음 로딩 시에도 동작하도록 트리거
        daySelect.dispatchEvent(new Event("change"));
    });
</script>
